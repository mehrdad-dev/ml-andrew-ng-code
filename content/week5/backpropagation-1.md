---
title: "ูพุณ ุงูุชุดุงุฑ ูุณูุช ุงูู"
date: 2020-10-01T12:30:31+03:30
draft: false
weight: 20
---
**<span class="top-dict" data-tipso="backpropagation">ูพุณ ุงูุชุดุงุฑ</span>**
ุฏุฑ ุดุจฺฉู ูุง ุนุตุจุ ุจุฑุง ุจู ุญุฏุงูู ุฑุณุงูุฏู ุชุงุจุน ูุฒูู
ูุซู ฺฉุงุฑ ฺฉู ุจุง ฺฏุฑุงุฏุงู ฺฉุงูุด ุฏุฑ ุฑฺฏุฑุณูู ูุฌุณุชฺฉ ู ุฎุท ุงูุฌุงู ูโุฏุงุฏูุ ุงุณุชูุงุฏู ูโุดูุฏ.

ูุฏู ูุง ูุญุงุณุจู ุงู ุงุณุช:

$$
min_\Theta J(\Theta)
$$

ุนู ูโุฎูุงูู ุชุงุจุน ูุฒู $J$ ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ ูุญููุนู
ุจููู ุงุฒ ูพุงุฑุงูุชุฑ $\Theta$ ุจู ุญุฏุงูู ุจุฑุณุงูู
(ุง ุจู ุนุจุงุฑุช ุฏฺฏุฑ ูููู ฺฉูู).

ุฏุฑ ุงู ุจุฎุด ุจู ูุนุงุฏูุงุช ฺฉู ุจุฑุง ูุญุงุณุจู ูุดุชู ุฌุฒุฆ ุชุงุจุน $J(\Theta)$ ุงุณุชูุงุฏู ูโฺฉููุ ุฎูุงูู ูพุฑุฏุงุฎุช:

$$
\frac{\partial}{\partial \Theta_ {i,j} ^{(l)}} J(\Theta)
$$

ุฏุฑ ูพุณ ุงูุชุดุงุฑ ูุง ุจุฑุง ูุฑ ฺฏุฑู ูุญุงุณุจู ุฎูุงูู ฺฉุฑุฏ:

$
= \delta_j ^{(l)}
$
ุฎุทุง ูุฑ ฺฏุฑู $j$ ุงู ุฏุฑ ูุงู $l$

{{% notice note %}}
ุจู ุฎุงุทุฑ ุขูุฑุฏ ฺฉู 
$ \delta_j ^{(l)} $
ฺฏุฑู ูุนุงู ุณุงุฒ $j$ ุฏุฑ ูุงู $l$ ุงุณุช.
{{% /notice %}}

ุจุฑุง ุขุฎุฑู ูุงู ุง ููุงู ูุงู ุฎุฑูุฌุ ูโุชูุงูู ุจุฑุฏุงุฑ ููุงุฏุฑ ุฏูุชุง ุฑุง ุจู ุงู ุตูุฑุช ุญุณุงุจ ฺฉูู:
$$
\delta ^{(L)} = a ^{(L)} - y
$$

ุจู ุทูุฑ ฺฉู $L$ ุชุนุฏุงุฏ ฺฉู ูุงู ูุง ูุง ุงุณุช ู
$a ^{(L)}$ ุจุฑุฏุงุฑ ุฎุฑูุฌ ฺฏุฑู ูุง ูุนุงู ุณุงุฒ ุฏุฑ ุขุฎุฑู ูุงู ุงุณุช.
ุจูุงุจุฑุงู ููุงุฏุฑ ุฎุทุง ูุง ุจุฑุง ุขุฎุฑู ูุงูุ ุชูุงูุช ูุชุงุฌ ูุงูุน ุฏุฑ ูุงู ุขุฎุฑ ู ุฎุฑูุฌ ุตุญุญ ุฏุฑ 
$y$ ุงุณุช.


ุจุฑุง ูุญุงุณุจู ููุงุฏุฑ ุฏูุชุงุ ูุงู ูุง ูุจู ุงุฒ ูุงู ุขุฎุฑ ูโุชูุงูู ุงุฒ ูุนุงุฏูู ุง ุงุณุชูุงุฏู ฺฉูู ฺฉู ูุง ุฑุง ุงุฒ ุณูุช ุฑุงุณุช ุจู ฺูพ ุนูุจ ูโโุจุฑุฏ:

$$
\delta ^{(l)} = ( (\Theta ^ {(l)}) ^ T  \delta ^ {(l+1)}) \hspace{0.2cm} .*  \hspace{0.2cm} {g}' (z^{(l)})
$$

ููุงุฏุฑ ุฏูุชุง ูุงู $l$ ุจุง ุถุฑุจ ููุงุฏุฑ ุฏูุชุง ุฏุฑ ูุงู ุจุนุฏ ุจุง ูุงุชุฑุณ ุชุชุง ูุงู $l$ ูุญุงุณุจู ูโุดูุฏุ
ุณูพุณ ุจู ุตูุฑุช ุนูุตุฑ ุจู ุนูุตุฑ ุขู ุฑุง ุฏุฑ ุชุงุจุน ุจู ุงุณู g-prime ุง ููุงู $g'$ ุถุฑุจ ูโฺฉูู.

ฺฉู $g'$ ูุดุชู ุชุงุจุน ูุนุงู ุณุงุฒ $g$ ุงุณุชุ ู ุจู ุนููุงู ูุฑูุฏ $z^{(l)}$ ุฑุง ูโฺฏุฑุฏ.

ุจุฎุด $g'$ ุฑุง ุจู ุตูุฑุช ุฒุฑ ูุฒ ูโุชูุงู ููุดุช:
$$
g'(u) = g(u) \hspace{0.2cm} .*  \hspace{0.2cm} (1 - g(u))
$$

ู ูุนุงุฏูู ฺฉุงูู ูพุณ ุงูุชุดุงุฑ ุจุฑุง ฺฏุฑู ูุง ุฏุงุฎู ุฑุง ุจู ุงู ุดฺฉู ูโููุณู:
$$
\delta ^{(l)} = ( (\Theta ^ {(l)}) ^ T  \delta ^ {(l+1)}) \hspace{0.2cm} .*  \hspace{0.2cm} a^{(l)}
\hspace{0.2cm} .*  \hspace{0.2cm}  (1 -  a^{(l)})
$$

ูุง ูโุชูุงูู ุจุง ุถุฑุจ ููุงุฏุฑ ูุนุงู ุณุงุฒ ุฏุฑ ููุงุฏุฑ ุฎุทุง ุจุฑุง ูุฑ ููููู ุขููุฒุด $t$ุ 
ูุดุชู ุฌุฒุฆ ุฎูุฏ ุฑุง ูุญุงุณุจู ฺฉูู:
$$
\frac{\partial}{\partial \Theta_ {i,j} ^{(l)}} J(\Theta) = \frac{1}{m} \sum_{t=1} ^m
a_j ^{(t) (l)} \delta _ i ^{(t) (l+1)}
$$

**ูฺฉุชู:**

$\delta ^{(l+1)}$ ู $a ^{(l+1)}$
ุจุฑุฏุงุฑ ูุง ุจุง $s_ {l+1}$ ุนุถู ูุณุชูุฏ ู
$a ^ {(l)}$ ุจุฑุฏุงุฑ ุจุง $s_l$ ุนุถู ุงุณุชุ
ฺฉู ุถุฑุจ ุขู ูุง ูุงุชุฑุณ ุชููุฏ ูโฺฉูุฏ ฺฉู $s_ {l+1}$ ุฏุฑ  $s_l$  ุงุณุชุ
ฺฉู ุงุจุนุงุฏ ุขู ุดุจู ุจู $\Theta^{(l)}$ ุงุณุช.

ฺฉู ุงู ูุฑุงูุฏ ุจุฑุง ูุฑ ุนูุตุฑ ููุฌูุฏ ุฏุฑ $\Theta^{(l)}$ ฺฏุฑุงุฏุงู ุชููุฏ ูโฺฉูุฏ.

### ุงูฺฏูุฑุชู ูพุณ ุงูุชุดุงุฑ

ุชุตูุฑ ฺฉูุฏ ฺูู ูุฌููุนู ุขููุฒุด ุฏุงุฑู:
$
\\{  (x^{(1)}, y^{(1)}) ... (x^{(m)}, y^{(m)}) \\}
$

- ุชูุธู $\Delta _{i,j} ^{(l)} := 0 $ ุจุฑุง ููู $(l,i,j)$ ูุง

ุจุฑุง ููููู ุขููุฒุด ุงุฒ $t=1$ ุชุง $m$:

- ุชูุธู $a ^{(1)} := x ^{(t)}$
- ุจุฑุง ุงูุฌุงู ุงูุชุดุงุฑ ุจู ุฌูู ูุญุงุณุจู $a ^{(1)}$ ุจุฑุง $l = 1,2,3, ... , L$ ุฑุง ุงูุฌุงู ูโุฏูู
- ุจุง ุงุณุชูุงุฏู ุงุฒ $y^{(t)}$ ุ ูุญุงุณุจู $\delta ^{(L)} = a ^{(L)} - y^{(t)}$ ุฑุง ุงูุฌุงู ูโุฏูู
- ูุญุงุณุจู $\delta^{(L-1)},\delta^{(L-2)}, ... , \delta^{(2)} $ ุจุง ุงุณุชูุงุฏู ุงุฒ $\delta ^{(l)} = ( (\Theta ^ {(l)}) ^ T  \delta ^ {(l+1)}) \hspace{0.2cm} .*  \hspace{0.2cm} a^{(l)}
\hspace{0.2cm} .*  \hspace{0.2cm}  (1 -  a^{(l)})$

- ูุญุงุณุจู $\Delta _{i,j} ^{(l)} := \Delta _{i,j} ^{(l)} + a_j ^{(l)} \delta _i ^{(l+1)} $ ุง ุจู ุตูุฑุช vectorization ูุญุงุณุจู $\Delta ^{(l)} := \Delta ^{(l)} + \delta ^{(l+1)} (a^{(l)})^ T$

- $D _{i,j} ^{(l)} := \frac{1}{m} (\Delta _{i,j} ^{(l)} + \lambda \Theta _{i,j} ^{(l)}) $ ุงฺฏุฑ $j \neq 0$ 

- $D _{i,j} ^{(l)} := \frac{1}{m} \Delta _{i,j} ^{(l)} $ ุงฺฏุฑ $j = 0$ 

ูุงุชุฑุณ ุฏูุชุง ุจุฒุฑฺฏ ุง ููุงู $\Delta$ ุจู ุนููุงู **<span class="top-dict" data-tipso="accumulator">ุงูุจุงุดุชฺฏุฑ</span>** ุจุฑุง ุฌูุน ุขูุฑ
ููุงุฏุฑ ูุง ุฏุฑ ุทูู ฺฉุงุฑ ู ูุญุงุณุจู ูุดุชู ุฌุฒุฆ ุงุณุชูุงุฏู ูโุดูุฏ.

ุงุซุจุงุช ูุงูุน ุงู ุงูฺฏูุฑุชู ฺฉุงููุง ูพฺุฏู ุงุณุชุ ููุงูุทูุฑ ฺฉู Andew Ng ูโฺฏูุฏ ฺฉู 
ุงุณุชูุชุงุฌ ู ุงุซุจุงุช ุขู ูพฺุฏู ุงุณุชุ ุงูุง ูุง ูโุชูุงูู ุงุฒ ูุนุงุฏูุงุช ุจุฑุง ุงูุฌุงู ฺฉุงุฑูุงู ุงุณุชูุงุฏู ฺฉูู ุจุฏูู ุฏุงูุณุชู ุฌุฒุฆุงุช ุขู.

ู $D _{i,j} ^{(l)} $ ุฌููู ุง ุงุณุช ฺฉู ูุง ุจุฑุง
ูุดุชูุงุช ุฌุฒุฆ ู ูุชุงุฌ ุจู ุฏูุจุงู ุขู ูุณุชู:

$$
D_ {i,j} ^{(l)} = \frac{\partial}{\partial \Theta_ {i,j} ^{(l)}} J(\Theta)
$$


![andrew-meme-1.webp](../images/andrew-meme-1.webp?width=30pc)
<p align="center" style="margin-top:-30px; margin-bottom: 50px; color: gray;" >
ุฎูุงุตู ฺฉู ุงูุฌูุฑู ุฏฺฏู ๐
<p>
